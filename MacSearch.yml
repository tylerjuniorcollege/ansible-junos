---

- name: Find mac address

  hosts: Junos_all

  gather_facts: false

  connection: local

  vars_prompt:

     - name: mac

       prompt: What is the mac address?

       private: no

  tasks:

    -

      name: debugging

      ansible.builtin.debug:

        msg: 'Searching for {{ mac }}'

    -

      name: search

      junos_command:

        commands:

          - "show mac address-table | match {{ mac }}"

      register: printout

    - set_fact:

        intf: |

          {{printout.stdout_lines[0] |

            map('regex_replace','^(?:[^ ]*\ ){12}([^ ]*)') |

            list }}

    -

      name: show int desc

      junos_command:

        commands:

          - "show interfaces description | match {{ intf[0].strip() }}"

      register: printout2

    - name: View output

      debug:

        var: printout2
