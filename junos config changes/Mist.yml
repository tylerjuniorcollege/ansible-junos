---
- name: Mist
  hosts: Junos_all
  roles:
    - Juniper.junos 
  connection: local
  gather_facts: no
 
  vars: 
    vaultpass: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32633633383833356136376663353033373566383236346435653138386664613736323235343633
          6561336465323961646264346331396263386364316430390a353464656337363239613061663539
          65616262373935386164313035336364316666643138623538656536346663663033313831616234
          6538336364653133350a663337383932623630373462653333626662653764323234303666653438
          30363664333937623662396265636131383862343261373436386531643866643137363931303338
          30373662353766373162663338656131326135376536343731386238343034383837333732633762
          63373530303861626635336534626263343835363365666338646661303864656533653031626334
          39356530386161323439623663646133396263363136383031636339616332313332356361306231
          33326364663365636261636332643835396239383434333730326130303061363266653965383834
          65613032643035363465626138323666626262666134313565303837633030333066613835616130
          306435343165346431386431623265313036



          
    vaultpass2: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66356437383338306131626431653066636464356232333735353262643639393936393265643766
          6164666232313461353035613133393935386334313062340a616336643861623063363365623334
          64356663353534393537376232643138386439323831646266666165393639363538613665326132
          3434333833346363390a373436653964356363373866333230366231316162633237333265653366
          32306264333239383639333362613038663139626162656338653433303961616565363436653366
          63346430303330383633646538306465393536333638336561383835363535316231623334623038
          33613439633461303863313236316532373335303938393334323433616432653933366265663131
          32306166316638386565366230633966303562316438386436323733313132633239613839376334
          31366530393938363232626631613664303065303963666536643262376132353430336433303235
          62313137386633646334616133616366383733373137653661626263663632373363336637306165
          31323633663734393636646634306134356131306339373933376234313433373531303032336234
          64386230306461326566663437393232613637373934313361353638356231396462363465373666
          38613465393938373064626463363239363033643366396437643132303234316531336163356235
          62353062653039623635633238643735623162313462643533333438383766306332643231383335
          38636630396562653864376135323538306162366663383533323736333066393534366262376563
          35633836386634363736656264313734633763663234613634333939656335636439653964306338
          31656163623465613861356134383331333335303835356234383834343838303562633965633634
          39333133326536333834396136343733666432636438333835326365343462393330306433343464
          38306338653439326230353364343833663536656430653436303138626235613834346164366337
          37656235313962666462343664353565303362303839333330343766306436653238303432373737
          37643536376637373035326534313465363864653339356330653262303333383432353231646636
          38653230663865333762323831633134663137643836303439316535353134666634353432336562
          37336435356333366635346431333533363563336535326664663234613162363665356431313863
          62623063316361346638346530633766636636306236656334363362353834633832306564303763
          66653731386562613863653863663564373161636232353730646563376633333066386566396334
          35636163396635636237643730393063363234303034346632396465336634623330633936386438
          37636133636334383461326238626536383437613734333063613938323932643133663063343935
          34346434376530653661663336393532396238356663323031333234303533386635623831363966
          32343664333637306663356434313131313833306431393931393138376263363466343330373739
          64333139653636353433353861633737336332326130353864336632393663376231636635326466
          31353336393138386365343039396538376437613433393563326132626339653362366461356437
          62643739666132656339326339653437356261636335316330313538373361646237316138343565
          39656338653232633037663532306532643235313063313636613434623633646665376132653334
          3565356237343637643435613236643338343333633934666461




  tasks: 
   - name: load configure lines into device
     junos_config:
       lines:
        - set system services ssh protocol-version v2
        - set system authentication-order password
        - set system login user mist class super-user
        - set system login user mist authentication encrypted-password {{ encryptedpassword }}
        - set system login user mist authentication ssh-rsa {{ vaultpass2 }}
        - set system services outbound-ssh client mist device-id c6ea753e-ef55-4baa-b111-3e4ce402330d
        - system services outbound-ssh client mist secret {{ vaultpass }}
        - set system services outbound-ssh client mist services netconf keep-alive retry 12 timeout 5
        - set system services outbound-ssh client mist oc-term.mistsys.net port 2200 timeout 60 retry 100
   
       comment: update config
